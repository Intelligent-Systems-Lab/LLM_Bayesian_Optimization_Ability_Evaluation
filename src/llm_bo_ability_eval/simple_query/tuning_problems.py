base_prompt = """
The base config is:
```json
{
    "dataset_name": "CIFAR10",
    "distribution": "non-iid",
    "dir_alpha": 0.5,
    "model_name": "resnet18",
    "num_clients": 10,
    "loss_function": "CrossEntropy",
    "selection_ratio_train": 1.0,
    "selection_ratio_eval": 1.0,
    "max_num_trials": 30,
    "rounds_per_trial": 3,
    "rounds_final_training": 90
}
```
Below are the trial results so far, please suggest the next hyperparameter configuration to try:
"""

# /home/jack/jacklab/flowerHome/morph_exp_backup_0803/bo_tpe_steps_by_steps_random_15t/deepseek_r1_p_claude_w_tool_w_summarizer/morph_orchid_1107065638_deepseekr1_morph.log
problem1_3sgd_1adm_admw = """
[{"trial_index": 1, "hyperparameters": {"batch_size": 32, "embedding_dim": 0, "epochs": 3, "hidden_size": 0, "learning_rate": 0.1, "loss_function": "CrossEntropy", "momentum": 0.9, "num_layers": 0, "optimizer": "sgd", "other_hp1": "", "other_hp2": "", "other_hp3": "", "seq_len": 0, "transforms": ["torchvision.transforms.ToTensor()", "torchvision.transforms.Normalize(mean=[0.5], std=[0.5])"], "weight_decay": 0.005}, "metrics": {"accuracy": 0.12563480629999998, "loss": 2.20910708}, "strategy": "random_search"}, {"trial_index": 2, "hyperparameters": {"batch_size": 64, "embedding_dim": 0, "epochs": 5, "hidden_size": 0, "learning_rate": 0.05, "loss_function": "CrossEntropy", "momentum": 0.9, "num_layers": 0, "optimizer": "sgd", "other_hp1": "", "other_hp2": "", "other_hp3": "", "seq_len": 0, "transforms": ["torchvision.transforms.ToTensor()", "torchvision.transforms.Normalize(mean=[0.5], std=[0.5])"], "weight_decay": 0.01}, "metrics": {"accuracy": 0.272522517, "loss": 1.9021755900000001}, "strategy": "random_search"}, {"trial_index": 3, "hyperparameters": {"batch_size": 64, "embedding_dim": 0, "epochs": 5, "hidden_size": 0, "learning_rate": 0.03, "loss_function": "CrossEntropy", "momentum": 0.9, "num_layers": 0, "optimizer": "sgd", "other_hp1": "", "other_hp2": "", "other_hp3": "", "seq_len": 0, "transforms": ["torchvision.transforms.ToTensor()", "torchvision.transforms.Normalize(mean=[0.5], std=[0.5])"], "weight_decay": 0.005}, "metrics": {"accuracy": 0.25060274, "loss": 1.8711532300000002}, "strategy": "random_search"}, {"trial_index": 4, "hyperparameters": {"batch_size": 64, "embedding_dim": 0, "epochs": 5, "hidden_size": 0, "learning_rate": 0.001, "loss_function": "CrossEntropy", "momentum": 0.0, "num_layers": 0, "optimizer": "adam", "other_hp1": "", "other_hp2": "", "other_hp3": "", "seq_len": 0, "transforms": ["torchvision.transforms.ToTensor()", "torchvision.transforms.Normalize(mean=[0.5], std=[0.5])"], "weight_decay": 0.01}, "metrics": {"accuracy": 0.19160022, "loss": 2.27171153}, "strategy": "random_search"}, {"trial_index": 5, "hyperparameters": {"batch_size": 64, "embedding_dim": 0, "epochs": 5, "hidden_size": 0, "learning_rate": 2e-05, "loss_function": "CrossEntropy", "momentum": 0.0, "num_layers": 0, "optimizer": "adamw", "other_hp1": "", "other_hp2": "", "other_hp3": "", "seq_len": 0, "transforms": ["torchvision.transforms.ToTensor()", "torchvision.transforms.Normalize(mean=[0.5], std=[0.5])"], "weight_decay": 0.01}, "metrics": {"accuracy": 0.389220004, "loss": 1.5631114499999998}, "strategy": "random_search"}]
"""

# /home/jack/jacklab/flowerHome/morph_exp_backup_0803/bo_tpe/gpt_o4_mini/morph_floptuna_0810222303_gpt-r2_morph.log
problem2 = """
[{'trial_index': 1, 'hyperparameters': {'batch_size': 64, 'epochs': 5, 'learning_rate': 0.041256, 'optimizer': 'adam'}, 'metrics': {'accuracy': 0.1010808646917534, 'loss': 0.038969492320541005}, 'strategy': 'random', 'thoughts': 'Initial random exploration: selected Adam with a high learning rate (0.041256) within [1e-5, 0.05] to probe upper-range behavior, and 5 local epochs to assess convergence speed.'}, {'trial_index': 2, 'hyperparameters': {'batch_size': 64, 'epochs': 2, 'learning_rate': 0.345678, 'optimizer': 'sgd'}, 'metrics': {'accuracy': 0.22277822257806246, 'loss': 0.03364021478413199}, 'strategy': 'random', 'thoughts': 'Trial 1’s Adam run at lr=0.041256 and 5 epochs yielded very low accuracy (~0.10), suggesting we may be overshooting or stuck. To diversify, I propose exploring SGD with a high learning rate of 0.345678 and fewer epochs (2) to test if larger, more aggressive steps with simpler optimizer dynamics can improve early convergence.'}, {'trial_index': 3, 'hyperparameters': {'batch_size': 64, 'epochs': 3, 'learning_rate': 0.001234, 'optimizer': 'adam'}, 'metrics': {'accuracy': 0.48698959167333866, 'loss': 0.022853598237228545}, 'strategy': 'random', 'thoughts': 'Given initial Adam at lr=0.041256 yielded poor accuracy and SGD at lr=0.345678 did better, I propose probing the lower end of Adam’s range to avoid overshooting. A learning rate of 0.001234 tests the mid-lower spectrum [1e-5,0.05] with moderate local epochs (3) to balance convergence and stability while continuing diverse random exploration.'}, {'trial_index': 4, 'hyperparameters': {'batch_size': 64, 'epochs': 4, 'learning_rate': 0.025678, 'optimizer': 'sgd'}, 'metrics': {'accuracy': 0.38871096877502004, 'loss': 0.02788914440630721}, 'strategy': 'random', 'thoughts': 'Continuing initial random exploration (trial 4) to probe lower-end SGD learning rates after the high-rate (0.345678) run achieved only ~22% accuracy. A moderate lr of 0.025678 with 4 local epochs balances step size and update frequency, helping assess if a gentler SGD step improves stability and performance on CIFAR-10.'}, {'trial_index': 5, 'hyperparameters': {'batch_size': 64, 'epochs': 5, 'learning_rate': 0.000567, 'optimizer': 'adam'}, 'metrics': {'accuracy': 0.516613290632506, 'loss': 0.021842869462443886}, 'strategy': 'random', 'thoughts': 'Building on the promising mid-low Adam rate (0.001234, accuracy≈0.49), I now sample deeper in the lower region to further stabilize training. A very low lr=0.000567 with 5 local epochs should allow the model to refine weights gently and assess if extended local updates yield better global accuracy without overshooting.'}]
"""

# /home/jack/jacklab/flowerHome/morph_exp_backup_0803/bo_tpe_steps_by_steps_random_15t/deepseek_r1_p_claude_w_tool_w_summarizer/morph_orchid_1107091310_deepseekr1_morph.log
problem3 = """
[{"trial_index": 1, "hyperparameters": {"batch_size": 32, "embedding_dim": 0, "epochs": 3, "hidden_size": 0, "learning_rate": 0.0001, "loss_function": "CrossEntropy", "momentum": 0.0, "num_layers": 0, "optimizer": "adam", "other_hp1": "", "other_hp2": "", "other_hp3": "", "seq_len": 0, "transforms": ["torchvision.transforms.ToTensor()", "torchvision.transforms.Normalize(mean=[0.5], std=[0.5])"], "weight_decay": 0.0001}, "metrics": {"accuracy": 0.345272417, "loss": 1.7744825800000001}, "strategy": "random search"}, {"trial_index": 2, "hyperparameters": {"batch_size": 64, "embedding_dim": 0, "epochs": 5, "hidden_size": 0, "learning_rate": 0.001, "loss_function": "CrossEntropy", "momentum": 0.0, "num_layers": 0, "optimizer": "adam", "other_hp1": "", "other_hp2": "", "other_hp3": "", "seq_len": 0, "transforms": ["torchvision.transforms.ToTensor()", "torchvision.transforms.Normalize(mean=[0.5], std=[0.5])"], "weight_decay": 0.001}, "metrics": {"accuracy": 0.217208392, "loss": 2.2263078499999995}, "strategy": "random search"}, {"trial_index": 3, "hyperparameters": {"batch_size": 64, "embedding_dim": 0, "epochs": 4, "hidden_size": 0, "learning_rate": 0.01, "loss_function": "CrossEntropy", "momentum": 0.9, "num_layers": 0, "optimizer": "sgd", "other_hp1": "", "other_hp2": "", "other_hp3": "", "seq_len": 0, "transforms": ["torchvision.transforms.ToTensor()", "torchvision.transforms.Normalize(mean=[0.5], std=[0.5])"], "weight_decay": 0.001}, "metrics": {"accuracy": 0.3243980169999999, "loss": 1.5856115600000003}, "strategy": "random search"}, {"trial_index": 4, "hyperparameters": {"batch_size": 64, "embedding_dim": 0, "epochs": 4, "hidden_size": 0, "learning_rate": 0.0003, "loss_function": "CrossEntropy", "momentum": 0.85, "num_layers": 0, "optimizer": "adam", "other_hp1": "", "other_hp2": "", "other_hp3": "", "seq_len": 0, "transforms": ["torchvision.transforms.ToTensor()", "torchvision.transforms.Normalize(mean=[0.5], std=[0.5])"], "weight_decay": 0.0003}, "metrics": {"accuracy": 0.281822458, "loss": 2.0175322700000002}, "strategy": "random search"}, {"trial_index": 5, "hyperparameters": {"batch_size": 32, "embedding_dim": 0, "epochs": 4, "hidden_size": 0, "learning_rate": 0.0003, "loss_function": "CrossEntropy", "momentum": 0.0, "num_layers": 0, "optimizer": "adam", "other_hp1": "", "other_hp2": "", "other_hp3": "", "seq_len": 0, "transforms": ["torchvision.transforms.ToTensor()", "torchvision.transforms.Normalize(mean=[0.5], std=[0.5])"], "weight_decay": 0.0003}, "metrics": {"accuracy": 0.308072972, "loss": 2.1108575999999997}, "strategy": "random search"}]
"""
